(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-198ff19b"],{"02c2":function(t,e,i){t.exports=i.p+"img/hu2.d1c0ce66.svg"},"10d5":function(t,e,i){t.exports=i.p+"img/hu5.2c9aaac8.svg"},"1f52":function(t,e,i){t.exports=i.p+"img/Group 428.7fc779ae.svg"},"2fdb":function(t,e,i){"use strict";var s=i("5ca1"),a=i("d2c8"),r="includes";s(s.P+s.F*i("5147")(r),"String",{includes:function(t){return!!~a(this,t,r).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"456d":function(t,e,i){var s=i("4bf8"),a=i("0d58");i("5eda")("keys",function(){return function(t){return a(s(t))}})},"504c":function(t,e,i){var s=i("9e1e"),a=i("0d58"),r=i("6821"),n=i("52a7").f;t.exports=function(t){return function(e){var i,o=r(e),c=a(o),u=c.length,l=0,m=[];while(u>l)i=c[l++],s&&!n.call(o,i)||m.push(t?[i,o[i]]:o[i]);return m}}},5147:function(t,e,i){var s=i("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[s]=!1,!"/./"[t](e)}catch(a){}}return!0}},5508:function(t,e,i){var s={"./hu1.svg":"80e6","./hu2.svg":"02c2","./hu3.svg":"5861","./hu4.svg":"c93d","./hu5.svg":"10d5"};function a(t){var e=r(t);return i(e)}function r(t){if(!i.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}a.keys=function(){return Object.keys(s)},a.resolve=r,t.exports=a,a.id="5508"},"57f8":function(t,e,i){t.exports=i.p+"img/Group 430.ac782c00.svg"},5861:function(t,e,i){t.exports=i.p+"img/hu3.4584b4af.svg"},"5eda":function(t,e,i){var s=i("5ca1"),a=i("8378"),r=i("79e5");t.exports=function(t,e){var i=(a.Object||{})[t]||Object[t],n={};n[t]=e(i),s(s.S+s.F*r(function(){i(1)}),"Object",n)}},6169:function(t,e,i){t.exports=i.p+"img/Group 429.ef174e45.svg"},6762:function(t,e,i){"use strict";var s=i("5ca1"),a=i("c366")(!0);s(s.P,"Array",{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},"7f7f":function(t,e,i){var s=i("86cc").f,a=Function.prototype,r=/^\s*function ([^ (]*)/,n="name";n in a||i("9e1e")&&s(a,n,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},"80e6":function(t,e,i){t.exports=i.p+"img/hu1.b84bf966.svg"},8615:function(t,e,i){var s=i("5ca1"),a=i("504c")(!1);s(s.S,"Object",{values:function(t){return a(t)}})},aae3:function(t,e,i){var s=i("d3f4"),a=i("2d95"),r=i("2b4c")("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==a(t))}},ac6a:function(t,e,i){for(var s=i("cadf"),a=i("0d58"),r=i("2aba"),n=i("7726"),o=i("32e9"),c=i("84f2"),u=i("2b4c"),l=u("iterator"),m=u("toStringTag"),f=c.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=a(g),p=0;p<h.length;p++){var d,v=h[p],y=g[v],b=n[v],x=b&&b.prototype;if(x&&(x[l]||o(x,l,f),x[m]||o(x,m,v),c[v]=f,y))for(d in s)x[d]||r(x,d,s[d],!0)}},c93d:function(t,e,i){t.exports=i.p+"img/hu4.408fb524.svg"},d2c8:function(t,e,i){var s=i("aae3"),a=i("be13");t.exports=function(t,e,i){if(s(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(a(t))}},ea95:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.totalmsg.length?s("div",{staticClass:"d-flex flex-column px-3",staticStyle:{"padding-bottom":"44px"}},[t._l(t.totalmsg,function(e,a){return s("div",{key:a},[e.customkey!==t.cookie.namekey?[s("div",{staticClass:"room-client"},[s("div",{staticClass:"item"},[s("div",{staticClass:"pic",style:{backgroundImage:"url("+i("5508")("./hu"+e.avatar+".svg")+")"}}),s("div",{staticClass:"name",attrs:{title:e.custom}},[t._v(t._s(e.custom))])]),s("div",{staticClass:"msg-w"},[e.msg?s("div",{staticClass:"msg"},[t._v(t._s(e.msg))]):t._e(),e.img?s("div",{staticClass:"mx-3"},[e.type?s("img",{attrs:{"max-width":"200",height:"150",src:e.img}}):s("div",{staticClass:"msg-file"},[s("i",{staticClass:"fas fa-file fa-4x"}),s("span",[t._v(t._s(e.name))]),s("a",{attrs:{href:e.img,target:"_blank"}},[t._v("下載")])])]):t._e(),s("span",[t._v(t._s(e.timestamp))])])])]:[s("div",{staticClass:"room-client local"},[s("div",{staticClass:"item"},[s("div",{staticClass:"pic",style:{backgroundImage:"url("+i("5508")("./hu"+e.avatar+".svg")+")"}}),s("div",{staticClass:"name",attrs:{title:e.custom}},[t._v(t._s(e.custom))])]),s("div",{staticClass:"msg-w"},[e.msg?s("div",{staticClass:"msg"},[t._v(t._s(e.msg))]):t._e(),e.img?s("div",{staticClass:"mx-3"},[e.type?s("img",{attrs:{"max-width":"200",height:"150",src:e.img}}):s("div",{staticClass:"msg-file"},[s("i",{staticClass:"fas fa-file fa-4x"}),s("span",[t._v(t._s(e.name))]),s("a",{attrs:{href:e.img,target:"_blank"}},[t._v("下載")])])]):t._e(),s("span",[s("a",{staticClass:"d-block",attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.delmsg(e.id)}}},[t._v("刪除")]),t._v("\n              "+t._s(e.timestamp)+"\n            ")])])])]],2)}),t.progress?s("div",{staticClass:"d-flex flex-column ml-auto"},[s("h5",{staticClass:"text-white"},[t._v("檔案傳送中")]),s("div",{staticClass:"progess",style:{width:t.progress+"px"}}),s("span",{staticClass:"text-center"},[t._v(t._s(t.progress))])]):t._e(),t.imgerror?s("p",{staticClass:"text-right text-white"},[t._v("\n      "+t._s(t.errormsg)+"\n    ")]):t._e()],2):t._e(),s("div",{staticClass:"chat-pos"},[s("div",{staticClass:"chat-msg"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.inputmsg,expression:"inputmsg",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"輸入聊天訊息"},domProps:{value:t.inputmsg},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.message()},input:function(e){e.target.composing||(t.inputmsg=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"chat-group"},[t._m(0),s("a",{staticStyle:{position:"relative"},attrs:{href:"#"}},[s("input",{ref:"file",staticStyle:{width:"0px",height:"0px",position:"absolute",opacity:"0"},attrs:{type:"file",id:"file"},on:{change:function(e){return t.upload(!1)}}}),t._m(1)]),s("a",{staticStyle:{position:"relative"},attrs:{href:"#"}},[s("input",{ref:"img",staticStyle:{width:"0px",height:"0px",position:"absolute",opacity:"0"},attrs:{type:"file",id:"img"},on:{change:function(e){return t.upload()}}}),t._m(2)])])])])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a",{attrs:{href:"#"}},[s("img",{attrs:{src:i("1f52"),width:"20px",height:"30px",alt:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"file mb-0",attrs:{for:"file"}},[s("img",{attrs:{src:i("6169"),width:"20px",height:"30px",alt:""}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"file mb-0",attrs:{for:"img"}},[s("img",{attrs:{src:i("57f8"),width:"20px",height:"30px",alt:""}})])}],r=(i("8615"),i("ac6a"),i("456d"),i("7f7f"),i("6762"),i("2fdb"),i("1157")),n=i.n(r),o={data:function(){return{tophide:!1,emoticonshow:!1,emoticon:"",cookie:{},progress:0,totalmsg:[],imgerror:!1,file:"",inputmsg:"",errormsg:""}},created:function(){return void 0===this.$cookie.get("name")||"clear"===this.$cookie.get("name")?(this.$router.push("/"),!1):(this.cookie=JSON.parse(this.$cookie.get("name")),""!==this.$route.query.room&&""!==this.$route.query.roomid||this.$router.push("/index"),this.inputmsg="",this.file="",this.updatemsg(),this.$nextTick(function(){var t=n()("html").prop("scrollHeight");n()("html").scrollTop(t)}),!0)},watch:{$route:function(){this.updatemsg()}},updated:function(){var t=n()("html").prop("scrollHeight");n()("html").scrollTop(t)},methods:{upload:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$bus.$emit("loading",!0);var i=["image/jpeg","image/jpg","image/gif","image/bmp","image/png","image/swf"],s=this.$firebase.storage().ref(),a=null;if(a=e?this.$refs.img.files[0]:this.$refs.file.files[0],void 0===a)return!1;var r=i.filter(function(t){return t.includes(a.type)});if(e&&0===r.length){var n=setTimeout(function(){t.imgerror=!1,clearTimeout(n)},2e3);return this.imgerror=!0,this.errormsg="請確認上傳的格式是否為jpeg,jpg,gif,bmp,png,swf",this.$refs.img.value="",this.$bus.$emit("loading",!1),!1}if(!e&&0!==r.length){var o=setTimeout(function(){t.imgerror=!1,clearTimeout(o)},2e3);return this.imgerror=!0,this.errormsg="請確認上傳的格式是否為文件格式",this.$refs.file.value="",this.$bus.$emit("loading",!1),!1}var c=s.child("images/".concat(a.name)).put(a);c.on("state_changed",function(e){t.progress=Math.ceil(e.bytesTransferred/e.totalBytes*100)},function(){},function(){c.snapshot.ref.getDownloadURL().then(function(e){t.file={downloadURL:e,name:a.name,type:a.type}}).then(function(){t.message(),t.$bus.$emit("loading",!1),t.$refs.file.value="",t.$refs.img.value="",t.inputmsg="",t.file="",t.progress=0})})},updatemsg:function(){var t=this;this.$bus.$emit("loading",!0),this.todaytopic=this.$route.query.room,this.room=this.$route.query.roomid,this.$firebase.database().ref("/".concat(this.$route.query.room,"/").concat(this.$route.query.roomid,"/msg")).on("value",function(e){if(t.totalmsg=[],null===e.val())return t.$bus.$emit("loading",!1),!1;var i=Object.keys(e.val()),s=Object.values(e.val());i.forEach(function(e,i){var a=new Date(100*s[i].timestamp).getHours(),r=new Date(100*s[i].timestamp).getMinutes(),n="";r<=9&&(r="0".concat(r)),n=a>=12?"下午".concat(a,":").concat(r):"上午".concat(a,":").concat(r);var o=["image/jpeg","image/jpg","image/gif","image/bmp","image/png","image/swf"],c=o.some(function(t){return t.includes(s[i].type)});t.totalmsg.push({id:e,custom:s[i].custom,customkey:s[i].customkey,timestamp:n,avatar:s[i].avatar,type:c,name:s[i].name,msg:s[i].msg,img:s[i].file,emoticon:s[i].emoticon}),t.$bus.$emit("loading",!1)})}),this.inputmsg="",this.file=""},delmsg:function(t){this.$firebase.database().ref("/".concat(this.$route.query.room,"/").concat(this.$route.query.roomid,"/msg")).child(t).remove(),this.updatemsg(this.$route.query.roomid)},message:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===this.inputmsg&&""===this.file&&""===t)return!1;var e=Math.floor(Date.now()/100);return this.$firebase.database().ref("/".concat(this.$route.query.room,"/").concat(this.$route.query.roomid,"/msg")).push({custom:this.cookie.name,customkey:this.cookie.namekey,timestamp:e,msg:this.inputmsg,avatar:this.cookie.nowavatar,name:this.file.name||"",file:this.file.downloadURL||"",type:this.file.type||"",emoticon:t}),this.updatemsg(this.$route.query.roomid),this.inputmsg="",this.file="",!0},loginout:function(){this.$cookie.set("name","clear"),this.$router.push("/")}}},c=o,u=i("2877"),l=Object(u["a"])(c,s,a,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-198ff19b.6d5eaad2.js.map